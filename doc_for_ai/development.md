## サービス概要
・サービス名：「皆can読」
・「皆 can 読」のように「漢字」と副詞に「アルファベット」を組み合わせることで、日本人も中国人も理解ができる新しい言語表現が見つかった。それを実際に試せる簡易的な掲示板。ここでは日本人と中国人が新規性のある新たな言語を試して交流できる場として試験的に解放する。
・ただし、これはSNS上のミーム的な扱いでもあるので、MVPとして簡易的にスピード重視で開発し、ミニマムにリリースする。
・ここでいう「漢字」には、繁体字も簡体字もどちらも含んだ広い意味での漢字として扱う。

## 機能概要
### 必要な機能
・**投稿機能(親投稿)**
	・ログイン不要で誰でもすぐに投稿ができる。
	・その際、「漢字（繁体語含む）」と「アルファベット」と「基本的な記号（!や?などコミュニケーションでよく使う記号）」のみが使用できる。それ以外の、ひらがなやカタカナ、ロシア語などが含まれていると投稿ができず、それらが投稿フォームに入力されると赤字で警告文章が適切な箇所に表示され、「「漢字（繁体・簡体含む）」と「アルファベット」と「基本的な記号（!や?などコミュニケーションでよく使う記号）」のみが使用できる」が表示される
	・投稿の際に利用規約を読んで許諾したかどうかのチェックボックスを設置。オンじゃないと投稿できない
	・投稿の際、ユーザーは自身の地域（日本、中国、そのほか）を選択できる
	・投稿データには「何分前の投稿か」と「返信の件数」が合わせて記載される。
	・投稿データには、作成日時（タイムスタンプ）を保持する。そして表示の際は、投稿日時を現在時刻と比較して、『〇〇分前』または『〇〇時間前』のように表示する。投稿から24時間以上経過した場合は、『〇月〇日』と日付で表示する
	・文字数制限 140文字まで
	・投稿フォームには、制限文字数と、入力中の文字数がフィードバックされる
・**返信機能(子投稿)**
	・親投稿に対して返信（子投稿）ができる。
	・ログイン不要で誰でもすぐに返信ができる。
	・その際、「漢字（繁体語含む）」と「アルファベット」と「基本的な記号（!や?などコミュニケーションでよく使う記号）」のみが使用できる。それ以外の、ひらがなやカタカナ、ロシア語などが含まれていると投稿ができず、それらが投稿フォームに入力されると赤字で警告文章が適切な箇所に表示され、「「漢字（繁体・簡体含む）」と「アルファベット」と「基本的な記号（!や?などコミュニケーションでよく使う記号）」のみが使用できる」が表示される
	・投稿の際に利用規約を読んで許諾したかどうかのチェックボックスを設置。オンじゃないと投稿できない
	・投稿の際、ユーザーは自身の地域（「日本」、「中国」、「他」）を選択できる
	・投稿データには「何分前の投稿か」と「返信の件数」が合わせて記載される。
	・投稿データには、作成日時（タイムスタンプ）を保持する。そして表示の際は、投稿日時を現在時刻と比較して、『〇〇分前』または『〇〇時間前』のように表示する。投稿から24時間以上経過した場合は、『〇月〇日』と日付で表示する
	・子投稿に対しては返信できない。
	・文字数制限 140文字まで
	・投稿フォームには、制限文字数と、入力中の文字数がフィードバックされる
・**閲覧機能**
	・ログイン不要で誰でも閲覧できる。
	・タイムライン形式で新着投稿が上部に来るように表示される。
	・投稿をクリックすると、その投稿の詳細ページにうつり、その投稿への返信が下部にタイムライン形式で表示される。
・個別の投稿（親投稿）に表示される内容は、「本文」「地域」「投稿日時」「返信件数」。地域の表示は「日本」、「中国」、「他」と漢字で表示される。
	・返信（子投稿）に表示される内容は、「本文」「地域」「投稿日時」。地域の表示は「日本」、「中国」、「他」と漢字で表示される。
### 不要な機能
・認証機能
	・ユーザーはログインなど一切なく、投稿、返信することができる
・それ以外にも、リアクション機能やソート機能は不要。
・投稿の削除機能


## 技術スタック

- フロントエンド：Next.js(AppRouter)
- バックエンド：next.js(API route)
- DB：Supabase (PostgreSQL)
- ホスティング：Vercel
- スタイリング：tailwind + shadcn/ui
- コード管理：GitHub
-  コードの品質管理：ESLint, Prettier


## DB構造
**テーブル設計方針**
- 親投稿と子投稿を1つのテーブルで管理
- 階層構造を表現するためにparent_idカラムを追加
- 地域情報はenum型で管理
- タイムスタンプはUTCで統一
**具体的なテーブル設計案**
- postsテーブル
	- id (UUID)
	- content (text)
	- region (enum: '日本', '中国','他')
	- parent_id (UUID, nullable)
	- created_at (timestamp with time zone)
	- updated_at (timestamp with time zone)
**インデックス設計**
- created_atに降順インデックス（タイムライン表示用）
- parent_idにインデックス（返信取得用）
**RLS設定**
- 匿名ユーザーでも読み書き可能
- ただし、更新・削除は不可


## Q&A

##### Supabaseの接続情報（URLとanon key）は既に設定されていますか？設定されていない場合、Supabaseプロジェクトの作成が必要です。
はい。設定済みです。
**Project URL**
```
https://zrohyodsmbdlqfeaxeon.supabase.co
```
**API Key**
```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inpyb2h5b2RzbWJkbHFmZWF4ZW9uIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzc2OTk3MjQsImV4cCI6MjA1MzI3NTcyNH0.g53nNFNvJVUhA0XFA2rA_ZihZwsk3Sr4DxPjLVjIAiQ
```

##### 投稿データのスキーマ設計について、以下の点を確認したいです：
**親投稿と子投稿を別テーブルにするか、1つのテーブルで管理するか**
一つのテーブル

**地域情報の保存方法（enum型か文字列か）**
PostgreSQLの組み込みの型としては、`TEXT`型で保存します。具体的な値は `'日本'`, `'中国'`, `'他'` とします。 ただし、Supabaseの管理画面上では、これらの値をカスタム型として作成し、型安全性を向上させることも考えられます。

**タイムスタンプのタイムゾーン設定（UTCかJSTか）**
UTC (協定世界時) で統一。データベースにはUTCで保存し、表示する際にユーザーのブラウザのタイムゾーン設定に基づいて変換します（例：`day.js`ライブラリを使用）。
##### 漢字、アルファベット、基本記号以外の文字を検出するための正規表現パターンはどのように定義しますか？
以下の正規表現パターンを使用します。これは、許可する文字（漢字、アルファベット、基本記号）以外を検出するパターンです。
```
/[^一-龠ぁ-ゔァ-ヴーa-zA-Z0-9! ? . , : ; ( ) \[ \] { } < > + - * / = % & # @ $ 、。〃〄々〆〇〡〢〣〤〥〦〧〨〩〸-〻㍐-㍗㎀-㏿ㇰ-ㇿ㐀-䶵一-鿕豈-頻並-龎]/g;
```
**許可する文字:**
- 漢字（日本語の常用漢字、人名用漢字、表外漢字、繁体字を含む、UnicodeのCJK統合漢字の範囲：`一-龠`, `㐀-䶵`, `一-鿕`, `豈-頻`, `並-龎`）
- アルファベット: 半角アルファベット (a-zA-Z)
- 数字: 半角数字 (0-9)
- 基本記号: `! ? . , : ; ( ) \[ \] { } < > + - * / = % & # @ $`
- 全角スペース

##### 繁体字と簡体字の区別は必要ですか？
いいえ、**初期段階では区別しません**。ユーザーは自由に投稿できます（繁体字、簡体字、日本語の漢字のいずれも可）。

##### Vercelのプロジェクトは既に作成されていますか？
はい、作成済みです。
##### 環境変数の設定方法について（Vercelのダッシュボードで設定するか、.env.localで管理するか）
**Vercelのダッシュボードで設定します**。`.env.local`はローカル開発環境で使用し、`.env.local`ファイル自体は`.gitignore`に追加して、gitの管理対象から外します。本番環境ではVercelのダッシュボードで設定した環境変数が使用されるため、秘匿情報を安全に管理できます。

**テストに関する方針**
- **単体テスト、統合テストの実施範囲**
    - **単体テスト:** 個々のコンポーネントや関数が正しく動作することを確認します。特に、以下の点が重要です。
        - 投稿や返信の入力バリデーション (文字種制限、文字数制限)
        - 投稿日時や経過時間の表示処理
        - API Routesの各エンドポイントの処理
    - 統合テストは開発速度を優先して行いません。
